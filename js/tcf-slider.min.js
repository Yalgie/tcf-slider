"use strict";jQuery.fn.tcf_slider=function(e){var n={loop:!0,autoChange:!0,transition:"slide",changeInterval:4e3,transitionDuration:400},i=$.extend({},n,e),a={init:function(){a.defineWrapElements(),a.defineElements(),a.buildWrappers(),a.buildPrevBtn(),a.buildImages(),a.loadImages(),a.buildNextBtn(),a.buildCrumbs(),a.bindClickEvents(),a.bindKeyboardEvents(),a.bindBlurEvents(),a.bindMouseOverEvents(),a.checkLoop(),a.bindResize(),i.autoChange&&a.bindInterval()},defineWrapElements:function(){i.eles.mainWrap=$("<div class='tcf-slider-wrap' />"),i.eles.imageWrap=$("<div class='tcf-slider-image-wrap' />"),i.eles.prevWrap=$("<div tabindex='0' class='tcf-slider-prev-wrap' />"),i.eles.nextWrap=$("<div tabindex='0' class='tcf-slider-next-wrap' />"),i.eles.crumbWrap=$("<div class='tcf-slider-crumb-wrap' />")},defineElements:function(){i.eles.prevBtn=$("<span class='tcf-slider-prev-btn'>&laquo;</span>"),i.eles.image=$("<img class='tcf-slider-image' />"),i.eles.nextBtn=$("<span class='tcf-slider-next-btn'>&raquo;</span>"),i.eles.crumb=$("<span tabindex='0' class='tcf-slider-crumb'>&bull;</span>")},buildWrappers:function(){i.eles.main.append(i.eles.mainWrap),i.eles.mainWrap.append(i.eles.prevWrap),i.eles.mainWrap.append(i.eles.imageWrap),i.eles.mainWrap.append(i.eles.nextWrap),i.eles.mainWrap.append(i.eles.crumbWrap)},buildPrevBtn:function(){i.eles.prevWrap.append(i.eles.prevBtn)},buildImages:function(){i.images.map(function(e,n){i.eles.imageWrap.append(i.eles.image.clone().hide().attr("src",e.src).attr("alt",e.alt).attr("title",e.caption))}),i.eles.imageWrap.children().first().show()},loadImages:function(){var e=i.eles.imageWrap.find("img"),n=0;e.load(function(){if(n++,n==e.length){var a=i.eles.crumbWrap.find(".active").index(),t=i.eles.imageWrap.children().eq(a).css("height");i.eles.mainWrap.css("height",t)}})},buildNextBtn:function(){i.eles.nextWrap.append(i.eles.nextBtn)},buildCrumbs:function(){i.images.map(function(e,n){i.eles.crumbWrap.append(i.eles.crumb.clone())}),i.eles.crumbWrap.children().first().addClass("active")},bindClickEvents:function(){i.eles.prevWrap.on("click",function(){a.changeImage("prev")}),i.eles.nextWrap.on("click",function(){a.changeImage("next")}),i.eles.crumbWrap.children().on("click",function(){a.changeImage("crumb",$(this).index())})},bindKeyboardEvents:function(){i.eles.prevWrap.on("keydown",function(e){13==e.which&&a.changeImage("prev",$(this).index())}),i.eles.nextWrap.on("keydown",function(e){13==e.which&&a.changeImage("next",$(this).index())}),i.eles.crumbWrap.children().on("keydown",function(e){13==e.which&&a.changeImage("crumb",$(this).index())})},bindBlurEvents:function(){i.eles.prevWrap.on("mouseout",function(){$(this).blur(),$(this).children().animate({marginLeft:0},{queue:!1})}),i.eles.nextWrap.on("mouseout",function(){$(this).blur(),$(this).children().animate({marginLeft:0},{queue:!1})}),i.eles.crumbWrap.children().on("mouseout",function(){$(this).blur()})},bindMouseOverEvents:function(){i.eles.prevWrap.on("mouseover",function(){$(this).focus()}),i.eles.nextWrap.on("mouseover",function(){$(this).focus()}),i.eles.crumbWrap.children().on("mouseover",function(){$(this).focus()})},changeImage:function(e,n){if(!i.animating){i.animating=!0;var t,s=i.eles.crumbWrap.find(".active").index();t="prev"==e?s-1:"next"==e?s+1:n,void 0==i.images[t]&&(t="prev"==e?i.images.length-1:0),a.transitionImage(s,t),a.updateCrumb(t),a.checkLoop()}},transitionImage:function(e,n){if("none"==i.transition)i.eles.imageWrap.children().eq(e).hide(),i.eles.imageWrap.children().eq(n).show(),i.animating=!1;else if("fade"==i.transition)i.eles.imageWrap.children().eq(e).fadeOut(i.transitionDuration,function(){i.eles.imageWrap.children().eq(n).fadeIn(i.transitionDuration),i.animating=!1});else if("slide"==i.transition){var a=i.eles.imageWrap.children().eq(e),t=i.eles.imageWrap.children().eq(n);i.eles.mainWrap.css("height",t.css("height")),a.addClass("tcf-abs"),t.addClass("tcf-abs").show(),n>e?(t.css("left","-100%"),a.animate({left:"100%"},{duration:i.transitionDuration,queue:!1}),t.animate({left:"0%"},{queue:!1,duration:i.transitionDuration,complete:function(){a.removeClass("tcf-abs").hide(),t.removeClass("tcf-abs"),i.animating=!1}})):(t.css("left","100%"),a.animate({left:"-100%"},{duration:i.transitionDuration,queue:!1}),t.animate({left:"0%"},{queue:!1,duration:i.transitionDuration,complete:function(){a.removeClass("tcf-abs").hide(),t.removeClass("tcf-abs"),i.animating=!1}}))}},updateCrumb:function(e){i.eles.crumbWrap.find(".active").removeClass("active"),i.eles.crumbWrap.children().eq(e).addClass("active")},checkLoop:function(){var e=i.eles.crumbWrap.find(".active").index(),n=i.images[e+1];i.loop||(0==e?i.eles.prevWrap.fadeOut():i.eles.prevWrap.fadeIn(),void 0==n?i.eles.nextWrap.fadeOut():i.eles.nextWrap.fadeIn())},bindResize:function(){$(window).on("resize",function(){var e=i.eles.crumbWrap.find(".active").index(),n=i.eles.imageWrap.children().eq(e).css("height");i.eles.mainWrap.css("height",n)})},bindInterval:function(){i.eles.timer=setInterval(function(){a.changeImage("next")},i.changeInterval),i.eles.mainWrap.on("mouseover",function(){clearInterval(i.eles.timer)}),i.eles.mainWrap.on("mouseout",function(){a.bindInterval()})}};return this.each(function(){i.eles={},i.eles.main=$(this),a.init(this)})};